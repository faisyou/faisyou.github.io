<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WhatsApp Embedded Signup & Security â€” Slide Deck</title>
  <style>
    :root{
      --bg:#f6f8fb;          /* light canvas */
      --card:#ffffff;        /* white */
      --ink:#0f172a;         /* slate-900 */
      --muted:#475569;       /* slate-600 */
      --brand:#0ea5e9;       /* sky-600 */
      --brand-2:#22c55e;     /* green-500 */
      --accent:#6366f1;      /* indigo-500 */
      --ok:#16a34a;          /* green-600 */
      --warn:#d97706;        /* amber-600 */
      --bad:#dc2626;         /* red-600 */
      --shadow: 0 6px 26px rgba(2,6,23,.08), 0 1px 0 rgba(2,6,23,.04);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0; font:16px/1.6 Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:var(--ink); background:
      radial-gradient(900px 600px at 80% -10%, rgba(14,165,233,.08), transparent 55%),
      radial-gradient(1000px 800px at -10% 0%, rgba(34,197,94,.08), transparent 60%),
      var(--bg);
    }
    .deck{max-width:1100px; margin:0 auto; padding:28px 18px 90px; position:relative}
    .controls{position:fixed; right:22px; bottom:22px; display:flex; gap:10px; z-index:10}
    .btn{background:var(--card); border:1px solid rgba(2,6,23,.08); box-shadow:var(--shadow); color:var(--ink); border-radius:12px; padding:10px 14px; font-weight:600; cursor:pointer}
    .btn:focus{outline:3px solid rgba(14,165,233,.35)}
    .progress{position:fixed; left:0; right:0; bottom:0; height:6px; background:rgba(2,6,23,.06)}
    .bar{height:100%; width:0%; background:linear-gradient(90deg,var(--brand), var(--accent))}
    .slide{background:var(--card); border:1px solid rgba(2,6,23,.06); box-shadow:var(--shadow); border-radius:var(--radius); padding:28px; margin:22px 0}
    .slide h1{font-size:42px; margin:0 0 10px}
    .slide h2{font-size:28px; margin:0 0 12px}
    .lead{color:var(--muted); font-size:18px}
    .tag{display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; background:rgba(14,165,233,.12); color:#075985; font-weight:600; letter-spacing:.2px; font-size:12px; border:1px solid rgba(14,165,233,.35)}
    .grid{display:grid; grid-template-columns:repeat(12,1fr); gap:18px}
    .span-6{grid-column:span 12}
    @media (min-width:900px){.span-6{grid-column:span 6}}
    .pill{display:inline-block; border-radius:10px; padding:3px 10px; font-size:12px; background:rgba(2,6,23,.06); border:1px solid rgba(2,6,23,.08)}
    ul.clean{margin:10px 0 0; padding-left:18px}
    li{margin:6px 0}
    .bad{color:var(--bad); font-weight:700}
    .ok{color:var(--ok); font-weight:700}
    .warn{color:var(--warn); font-weight:700}
    .kpi{display:flex; gap:12px; flex-wrap:wrap; margin-top:16px}
    .kpi .box{flex:1 1 170px; padding:16px; border-radius:14px; border:1px solid rgba(2,6,23,.08); background:#fbfdff}
    .code{background:#f3f6fb; border:1px solid rgba(2,6,23,.08); border-radius:12px; padding:14px; overflow:auto; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; font-size:13px}
    .notes{margin-top:14px; padding:12px 14px; border-radius:12px; background:#fafdff; border:1px dashed rgba(2,6,23,.15)}
    .center{display:flex; align-items:center; justify-content:center}

    /* Print each slide as a page */
    @media print{
      .controls, .progress{display:none}
      .slide{page-break-after:always}
    }
  </style>
</head>
<body>
  <main class="deck" aria-label="Presentation: WhatsApp Embedded Signup & Security">

    <!-- Slide 1: Title -->
    <section class="slide" data-title="Title">
      <span class="tag">ğŸ” WhatsApp Business â€¢ Embedded Signup</span>
      <h1>Embedded Signup & Security â€” Illustrated</h1>
      <p class="lead">E2EE is built into the WhatsApp protocol. Providers still need strong operational security once data reaches business systems.</p>
      <div class="kpi">
        <div class="box"><b>Protocol</b><div class="muted">Signalâ€‘based E2EE</div></div>
        <div class="box"><b>Auth</b><div class="muted">OAuth 2.0, shortâ€‘lived tokens</div></div>
        <div class="box"><b>Transport</b><div class="muted">TLS for APIs & Webhooks</div></div>
        <div class="box"><b>Risk Zone</b><div class="muted">BSP ops & storage</div></div>
      </div>
    </section>

    <!-- Slide 2: High-level diagram -->
    <section class="slide" data-title="Overview Diagram">
      <h2>How the Pieces Fit Together</h2>
      <div class="grid">
        <div class="span-6">
          <svg viewBox="0 0 560 250" role="img" aria-label="OAuth signup and E2EE messaging">
            <defs>
              <linearGradient id="lg" x1="0" x2="1">
                <stop offset="0%" stop-color="#0ea5e9" stop-opacity=".5"/>
                <stop offset="100%" stop-color="#6366f1" stop-opacity=".5"/>
              </linearGradient>
            </defs>
            <!-- Signup lane -->
            <text x="10" y="18" fill="#475569" font-size="12">Embedded Signup (OAuth2)</text>
            <rect x="10" y="28" width="140" height="52" rx="12" fill="#ffffff" stroke="#e2e8f0"/>
            <text x="20" y="58" fill="#0f172a" font-size="12">Admin ğŸ‘¤</text>
            <rect x="180" y="28" width="160" height="52" rx="12" fill="#ffffff" stroke="#e2e8f0"/>
            <text x="190" y="58" fill="#0f172a" font-size="12">Meta OAuth ğŸ”‘</text>
            <rect x="370" y="28" width="170" height="52" rx="12" fill="#ffffff" stroke="#e2e8f0"/>
            <text x="380" y="58" fill="#0f172a" font-size="12">BSP Platform ğŸ§©</text>
            <path d="M150,54 L180,54" stroke="url(#lg)" stroke-width="3"/>
            <path d="M340,54 L370,54" stroke="url(#lg)" stroke-width="3"/>
            <!-- Messaging lane -->
            <text x="10" y="120" fill="#475569" font-size="12">Messaging (Endâ€‘toâ€‘End Encrypted)</text>
            <rect x="10" y="130" width="140" height="52" rx="12" fill="#ffffff" stroke="#e2e8f0"/>
            <text x="20" y="160" fill="#0f172a" font-size="12">Customer ğŸ“±</text>
            <rect x="180" y="130" width="160" height="52" rx="12" fill="#ffffff" stroke="#e2e8f0"/>
            <text x="190" y="160" fill="#0f172a" font-size="12">WA Servers â˜ï¸</text>
            <rect x="370" y="130" width="170" height="52" rx="12" fill="#ffffff" stroke="#e2e8f0"/>
            <text x="380" y="160" fill="#0f172a" font-size="12">Business App ğŸ¤</text>
            <path d="M150,156 L180,156" stroke="#0ea5e9" stroke-width="3"/>
            <path d="M340,156 L370,156" stroke="#0ea5e9" stroke-width="3"/>
            <!-- Risk box -->
            <rect x="340" y="194" width="200" height="42" rx="10" fill="rgba(220,38,38,.06)" stroke="#fecaca"/>
            <text x="350" y="220" fill="#b91c1c" font-size="12">Risk: tokens, webhooks, logs</text>
          </svg>
        </div>
        <div class="span-6">
          <ul class="clean">
            <li>ğŸ”’ <b>E2EE</b> is deviceâ€‘toâ€‘device; servers relay ciphertext only.</li>
            <li>ğŸ”‘ <b>OAuth2</b> grants scoped tokens; BSP never sees Meta passwords.</li>
            <li>ğŸŒ <b>TLS</b> protects API + webhook transport.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Slide 3: Protocol level security -->
    <section class="slide" data-title="Protocol Security">
      <h2>Protocolâ€‘Level Security (Builtâ€‘in)</h2>
      <ul class="clean">
        <li>ğŸ” <b>Signalâ€‘style Double Ratchet</b> â€” forward secrecy & postâ€‘compromise security.</li>
        <li>ğŸ—ï¸ <b>Perâ€‘device keys</b> â€” generated and stored on devices; servers canâ€™t decrypt.</li>
        <li>ğŸ§¾ <b>Identity keys & safety numbers</b> â€” mitigate MITM and impersonation.</li>
      </ul>
      <div class="notes"><b>Speaker note:</b> Emphasize that E2EE applies to message content in transit; business systems see plaintext <em>after</em> decryption on their side.</div>
    </section>

    <!-- Slide 4: Embedded signup steps -->
    <section class="slide" data-title="Signup Steps">
      <h2>Embedded Signup â€” Quick Steps</h2>
      <ol class="clean">
        <li>ğŸ‘¤ Start signup inside BSP platform.</li>
        <li>ğŸ”‘ Redirect to <b>Meta OAuth</b> for consent.</li>
        <li>ğŸŸï¸ BSP receives <b>scoped, shortâ€‘lived tokens</b> to configure WABA & number.</li>
        <li>ğŸ“ Verify <b>phone number ownership</b>.</li>
        <li>ğŸŒ Set <span class="pill">Webhook URL (HTTPS)</span> & <span class="pill">App Secret</span>.</li>
        <li>ğŸš€ Start messaging via the Business API (cloud/onâ€‘prem).</li>
      </ol>
    </section>

    <!-- Slide 5: What protocol doesnâ€™t cover -->
    <section class="slide" data-title="Gaps">
      <h2>What the Protocol Does <u>Not</u> Cover</h2>
      <ul class="clean">
        <li>ğŸ“¥ <b>Postâ€‘decryption handling</b> in CRMs, bots, data lakes.</li>
        <li>ğŸ” <b>Access control</b> for staff, dashboards, exports.</li>
        <li>ğŸ§° <b>Webhook/API hardening</b>, rate limits, replay protection.</li>
      </ul>
    </section>

    <!-- Slide 6: BSP responsibilities -->
    <section class="slide" data-title="BSP Duties">
      <h2>BSP / Serviceâ€‘Provider Responsibilities</h2>
      <div class="grid">
        <div class="span-6">
          <ul class="clean">
            <li>ğŸ” <b>Secret management</b> â€” vault tokens, certs; enable rotation.</li>
            <li>ğŸ›¡ï¸ <b>Transport security</b> â€” HTTPS/TLS 1.2+, HSTS, strong ciphers.</li>
            <li>ğŸ§° <b>Webhook integrity</b> â€” verify signatures, reject replays.</li>
          </ul>
        </div>
        <div class="span-6">
          <ul class="clean">
            <li>ğŸ§‘â€ğŸš’ <b>Least privilege & RBAC</b> â€” SSO/MFA, separated duties.</li>
            <li>ğŸ§¯ <b>Data minimization</b> â€” avoid storing bodies; if needed, encrypt+TTL.</li>
            <li>ğŸ” <b>Audit & monitoring</b> â€” immutable logs, alerts, IR runbooks.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Slide 7: Negligence risks -->
    <section class="slide" data-title="Risks">
      <h2>If the Provider Is Negligentâ€¦</h2>
      <ul class="clean">
        <li class="bad">Token leakage â†’ account hijack / spam</li>
        <li class="bad">Unverified webhooks â†’ spoofed events</li>
        <li class="bad">Verbose logs with plaintext PII</li>
        <li class="warn">Weak TLS â†’ MITM on callbacks</li>
        <li class="warn">Overâ€‘privileged staff or API keys</li>
      </ul>
    </section>

    <!-- Slide 8: Checklist -->
    <section class="slide" data-title="Checklist">
      <h2>Security Checklist</h2>
      <div class="grid">
        <div class="span-6">
          <ul class="clean">
            <li class="ok">Vaulted secrets (KMS/HSM)</li>
            <li class="ok">Shortâ€‘lived tokens + rotation</li>
            <li class="ok">Webhook signature verification</li>
          </ul>
        </div>
        <div class="span-6">
          <ul class="clean">
            <li class="ok">TLS 1.2+/HSTS, mTLS if possible</li>
            <li class="ok">RBAC + MFA + SSO</li>
            <li class="ok">Encrypt at rest, define TTLs</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Slide 9: Developer tips -->
    <section class="slide" data-title="Dev Tips">
      <h2>Developer Tips â€” Sample Verifications</h2>
      <div class="code">
<pre># Verify X-Hub-Signature-256 for webhook (pseudocode)
expected = hmac_sha256(app_secret, request_body)
assert timing_safe_eq('sha256=' + expected_hex, headers['X-Hub-Signature-256'])

# App-Secret Proof for Graph API calls
proof = hmac_sha256(app_secret, access_token)
GET /endpoint?appsecret_proof={proof_hex}
</pre>
      </div>
      <div class="notes"><b>Speaker note:</b> Use constantâ€‘time comparisons; log failed validations with request IDs.</div>
    </section>

    <!-- Slide 10: Takeaways -->
    <section class="slide" data-title="Takeaways">
      <h2>Key Takeaways</h2>
      <ul class="clean">
        <li>âœ… <b>E2EE is embedded in WhatsAppâ€™s protocol</b> â€” servers/BSPs canâ€™t read content in transit.</li>
        <li>ğŸ§© <b>Operational diligence is essential</b> once data reaches business systems.</li>
        <li>ğŸ§· <b>Harden signup + webhooks + token storage</b> to avoid hijack, spoofing, leaks.</li>
      </ul>
    </section>

    <!-- Controls -->
    <div class="controls" aria-label="Slide controls">
      <button class="btn" id="prev" aria-label="Previous slide">â—€</button>
      <button class="btn" id="next" aria-label="Next slide">Next â–¶</button>
      <button class="btn" id="print" aria-label="Print deck">ğŸ–¨ï¸ Print</button>
    </div>
    <div class="progress" aria-hidden="true"><div cla
